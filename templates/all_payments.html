{% extends "base.html" %}
{% load static %}
{% block title %}
	All Payments
{% endblock title %}

{% block body %}
	<div class="container">
		<p class="fw-bold fs-1 text text-center"> All Payments</p>
		<div class="range-search">
			<form method="get" class="mb-3"> {% csrf_token %}
				<div class="row align-items-end">
					<div class="col">
						<label for="start-date" class ="form-label fw-medium">Start Date</label>
						<input type="date" id="start-date" name="start_date" class="form-control" placeholder="Start Date" value="{{ request.GET.start_date }}">
					</div>
					<div class="col">
						<label for="end-date" class ="form-label fw-medium">End Date</label>
						<input type="date" id="end-date" name="end_date" class="form-control" placeholder="End Date" value="{{ request.GET.end_date }}">
					</div>
					<div class="col">
						<button type="submit" class="btn btn-primary">Search</button>
					</div>
				</div>
			</form>
		</div>
		<div class="table-responsive">
			{% if total_amount %}
			<p class="text text-center fw-normal fs-4">
				Total Payment : 
				<strong>
					{% if total_amount %}
						{{total_amount}}
					{% else %}
						0
					{% endif %}
				</strong>
			</p>
			{% endif %}
			<table class="table  table-striped table-hover table-borderless align-middle ">
				<thead>
					<tr>
						<th scope = "col">Student</th>
						<th scope = "col">Board</th>
						<th scope = "col">Class</th>
						<th scope = "col">Subject</th>
						<th scope = "col">Amount</th>
						<th scope = "col">Total Due</th>
						<th scope = "col">Payment Method</th>
						<th scope = "col">Payment Date</th>
						<th scope = "col">Payment of Months</th>
						<th scope = "col">Modification</th>
					</tr>
				</thead>
				<tbody>
					{% for payment in payments %}
						<tr>
							<td>{{ payment.student.name }}</td>
							<td>{{ payment.student.board }}</td>
                            <td>{{ payment.student.student_class }}</td>
                            <td>{{ payment.student.subject }}</td>
							<td>{{ payment.amount }}</td>
							<td class="{% if payment.due_amount > 0 %} text-danger {% endif %}">{{ payment.due_amount }}</td>
							<td>{{ payment.payment_method }}</td>
							<td>{{ payment.date }}</td>
							<td><strong>{{payment.year}}: </strong> {{ payment.months }}</td>
							<td>{{payment.modification}}</td>
						</tr>
					{% empty %}
						<tr>
							<td colspan="5" class="text-center">No payment record found.</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
{% endblock body %}